# コヨーテAIゲームの戦略

## コヨーテに大切な制約

コヨーテのゲームの本質は、自分がゲームを終わらせないのであれば、少なくとも+1以上の数を現在の盤面の合計値に加えなければならないという制約が存在する。

また、もう一つの要素としては盤面の中で常にわからない情報は、自分のカードだけであるということがあげられる。つまり、まず初めに、自分のカードがわかりきっている状態では確定ゲームになる。

そこで私は次のようなアプローチでコヨーテの最適戦略を練ることにした。

- 自分のカードが完全にわかった状態での最適戦略を考える。
- ?が存在する条件下での最適戦略を考える。
- その後自分のカードがわからない状態での自分のカードの確率分布から自分のカードを推定する。
- その後、推定したカード情報を元に最適戦略化での最適戦略を考える。
- 最適戦略を行うモデルに対して強化学習を行いブラフを学習させる


## 自分のカードが完全にわかっている場合のコヨーテ（？なし）

自分のカードが完全にわかっている場合、最適戦略は数学的にとかなくともtotal-1を初めに宣言し、その後つぎの人がtotalをいうしかなくそれによってゲームは終了する。$f(x,x_1,x_2,x_3,x_4,x_5)$がコヨーテカードの出色された全体の集合であると仮定して、次のようにtotalを定義する。
$$
    T = total = f(x_1, x_2, x_3, x_4,x_5 ,x)
$$
ゆえに初手を出すことができる人が確実に勝てるゲームになる。

## ?が存在する時のコヨーテゲーム

?が存在する場合は話が変わってくる。まず初めに?存在下での最適戦略を考えよう。

- ?が存在する場合、自分のカードでも誰でもそれが?であるということを認識することができる。
- この場合？は少なくとも完全にランダムでなければならない。

ゆえに、?を推察することができればこのゲームは勝利することができる。

ここで重要なことは少なくとも?によりもたらされる確率により勝敗が決するということである。
つまり、？が存在する場合の確率分布と期待値を計算することで、勝てなくなる手を打つことがないようにできるはずである。

ここでコヨーテのゲームにおいて重要だと思われることは、次のターンが回ってきた場合には、自分の数の+6を必ずしなければならないということである。
そこで、このゲームの場合のEstimateは全員同じはずであるならば、最初にできるだけ高いestimate-Nを宣言する。逆に、estimate-Nを宣言された場合には、基本的に、そのゲームにおいて勝利する確率が低くなるために、（このゲームにおいては、Estimateの確率分布は、基本的に存在しうる手札の確率分布に従う。そこで、このゲームに置いて、高い数字を宣言することは、相手に対して、コヨーテされる確率を高め、さらにコヨーテされたときに負ける確率が高くなる。）つまり基本的に確率分布に従った方が確立として高いと考えられる。特に複数回行うゲームではその確率は非常に高くなる。
そのために確率的に考えるとこの場合のコヨーテゲームは、確率分布に従って行動することが最適戦略になる。



## ?が複数枚存在する時のコヨーテ

?が複数枚存在する場合にも、まずは基本的にありえる通りを全て計算する必要がある。
そこで?が存在する場合にも非存在の場合にも、基本的にありえる通りを全て計算する必要があると考える。

そこでありうる手を全て計算することにより、その確率分布を計算することができる。
そこで、確率分布から、現在コヨーテしたときに、勝てる確率を計算することができる。
コヨーテを宣言することは基本的に確率的挙動である。

また、この場合のコヨーテについては自分が、?を引く可能性もあるためその可能性も考えておく必要がある。
そのため、この時のコヨーテの宣言タイミングは、固定となる可能性が高い。そこで自分がコヨーテする確率として、確実な場合を除いて



### 確率を計算することに対する障壁

1. 確率を計算をするために必要な情報が基本的に、実装的に手札のカウンティングができない。
2. 自分のターン終了後に自分の手札を取得することができない。
3. 自分のターンがこない場合には、そのゲームの観測ができない。

など、今回かなりの障壁がある。（先に取得可能な手札について定義していなかったことが悪いが）
しかし全員ほとんど同じ条件である。そこで、カードを推測することにしよう。


## Baseモデル

Baseモデルとして、Coyo-teゲームのランダムなエージェントを考える。

